- type: Exchange
  request: |
    !OciManifest
    image: nginx:latest
  response:
    type: Success
    payload: '{"schemaVersion":2,"mediaType":"application/vnd.oci.image.index.v1+json","manifests":[{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:12549785f32b3daca6f1c39e7d756226eeb0e8bb20b9e2d8a03d484160862b58","size":2290,"platform":{"architecture":"amd64","os":"linux"},"annotations":{"com.docker.official-images.bashbrew.arch":"amd64","org.opencontainers.image.base.digest":"sha256:282702dac844f3030e10c3cfbfd9629a54345ac7980b296da69d8a3797a4d91b","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T21:49:39Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:c138915a1f255004ac5939fe7b2e69d983981944fbc2e0fa4cc60cb883c00c49","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"amd64","vnd.docker.reference.digest":"sha256:12549785f32b3daca6f1c39e7d756226eeb0e8bb20b9e2d8a03d484160862b58","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:4a6cc8b6468085cd469b020f485d489db0488c9fe1bb938ee1050ffac0db2c48","size":2292,"platform":{"architecture":"arm","os":"linux","variant":"v5"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm32v5","org.opencontainers.image.base.digest":"sha256:7f0779ff1ae884840af5da2387a67bb19aead0e0ce4e27041a70bf5f6e9c7fb8","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T21:47:12Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:0aa5ccd35e05c314848fc0cf52119ec08a780580bf7382c050fb9005a06bd34b","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm32v5","vnd.docker.reference.digest":"sha256:4a6cc8b6468085cd469b020f485d489db0488c9fe1bb938ee1050ffac0db2c48","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:da1dc186597f0d80123be6375d0266f99a6a247037a77901afc9aacc202019cb","size":2292,"platform":{"architecture":"arm","os":"linux","variant":"v7"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm32v7","org.opencontainers.image.base.digest":"sha256:0ebd0144645fb08dfe1a3ba71c11570b24b7aad7e0801fd3813ab3031d5e601b","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T21:47:08Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:322f5b38162a9f5e4804615eb67aff84c35e172f449d55e2b073b452ce5de0c4","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm32v7","vnd.docker.reference.digest":"sha256:da1dc186597f0d80123be6375d0266f99a6a247037a77901afc9aacc202019cb","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:89a1bafe028b2980994d974115ee7268ef851a6eb7c9cb9626d8035b08ba4424","size":2292,"platform":{"architecture":"arm64","os":"linux","variant":"v8"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm64v8","org.opencontainers.image.base.digest":"sha256:8a909a24835f7f9bf4f2bb049ac053dae37ad5b1afcfe6f4082079cf63aea81b","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T22:42:09Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:e502db860339a444104ebcf555fc7c79a0ae7c89d3e459fe2f72ffe0ffe4b379","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"arm64v8","vnd.docker.reference.digest":"sha256:89a1bafe028b2980994d974115ee7268ef851a6eb7c9cb9626d8035b08ba4424","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:a1b94424bee7a26b67fb43746a78e5424f2d3c491995323637847e5cf83be0c1","size":2289,"platform":{"architecture":"386","os":"linux"},"annotations":{"com.docker.official-images.bashbrew.arch":"i386","org.opencontainers.image.base.digest":"sha256:87103008d07892ab1ccf11b47dcea1e0a1c68e6c3058a68b2f877c37332c6cd1","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T21:47:10Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:7aa77689ba2c5ffbab94ebd9b34f92d5b44926ca6135fc3a60bf06f15c1e8c3a","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"i386","vnd.docker.reference.digest":"sha256:a1b94424bee7a26b67fb43746a78e5424f2d3c491995323637847e5cf83be0c1","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:ad06fdff14bc577c7e7074ffd0ea26aff903d29d601962564a54da6e65f8dd25","size":2292,"platform":{"architecture":"ppc64le","os":"linux"},"annotations":{"com.docker.official-images.bashbrew.arch":"ppc64le","org.opencontainers.image.base.digest":"sha256:ac9f40b4e035fc6266c4f9f619c7cd7b52e90f128fff124a094127813cf6832e","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-28T21:53:27Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:5a211cf0467389c3a40ac6b0d6c80b1f43da12e98a93ae52efe34ab96b0e8458","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"ppc64le","vnd.docker.reference.digest":"sha256:ad06fdff14bc577c7e7074ffd0ea26aff903d29d601962564a54da6e65f8dd25","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:d41946c7cd5dc533af5ec540ce17e4677bbd306e63fd201f3e91d37acdf3bf1e","size":2292,"platform":{"architecture":"riscv64","os":"linux"},"annotations":{"com.docker.official-images.bashbrew.arch":"riscv64","org.opencontainers.image.base.digest":"sha256:b4d381846501788dc85f7d800156cd0da06ea6f407048db077ed339f3b406a89","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-21T03:45:18Z","org.opencontainers.image.revision":"c3785f2653008f9354c3d29a54d8c5459c53fa60","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#c3785f2653008f9354c3d29a54d8c5459c53fa60:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.2"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:a5def97b11216e6ef94427c53758f19d1577d1ac2c6366d21954d13eaeb782f5","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"riscv64","vnd.docker.reference.digest":"sha256:d41946c7cd5dc533af5ec540ce17e4677bbd306e63fd201f3e91d37acdf3bf1e","vnd.docker.reference.type":"attestation-manifest"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:33a20244860b2fd872e1952ea5b705143867437a366299f75adc2cb39ae97078","size":2290,"platform":{"architecture":"s390x","os":"linux"},"annotations":{"com.docker.official-images.bashbrew.arch":"s390x","org.opencontainers.image.base.digest":"sha256:f59d85e5f29df80c5a20f44c9063fcef007c8a9ffb6a53137c946882ee8bac76","org.opencontainers.image.base.name":"debian:trixie-slim","org.opencontainers.image.created":"2025-10-29T00:25:42Z","org.opencontainers.image.revision":"e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff","org.opencontainers.image.source":"https://github.com/nginx/docker-nginx.git#e4d5453581d9d3618f77c4aeccf2e6171a1cd6ff:mainline/debian","org.opencontainers.image.url":"https://hub.docker.com/_/nginx","org.opencontainers.image.version":"1.29.3"}},{"mediaType":"application/vnd.oci.image.manifest.v1+json","digest":"sha256:9ca36b48486ae57d07953f3c2b0c8491edfccfed139bd14440fc7c90c043eff2","size":841,"platform":{"architecture":"unknown","os":"unknown"},"annotations":{"com.docker.official-images.bashbrew.arch":"s390x","vnd.docker.reference.digest":"sha256:33a20244860b2fd872e1952ea5b705143867437a366299f75adc2cb39ae97078","vnd.docker.reference.type":"attestation-manifest"}}]}'
- type: Exchange
  request: |
    !KubernetesListResourceNamespace
    api_version: storage.sbomscanner.kubewarden.io/v1alpha1
    kind: VulnerabilityReport
    namespace: default
    label_selector: null
    field_selector: imageMetadata.digest=sha256:12549785f32b3daca6f1c39e7d756226eeb0e8bb20b9e2d8a03d484160862b58
  response:
    type: Success
    payload: '{"apiVersion":"storage.sbomscanner.kubewarden.io/v1alpha1","kind":"VulnerabilityReportList","metadata":{},"items":[]}'
